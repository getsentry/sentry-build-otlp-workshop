# =============================================================================
# OTEL E-COMMERCE API - ENVIRONMENT VARIABLES
# =============================================================================

# =============================================================================
# MODE 1: DIRECT (OTEL SDK → Sentry)
# =============================================================================
# Single service sending directly to a single Sentry project.
# This demonstrates standard OTEL SDK usage with Sentry.
#
# To run:
#   npm start  (or: npm run direct)
#
# Get these values from:
#   Sentry → Settings → Projects → [Your Project] → Client Keys (DSN)
#   Click on a DSN → scroll to "OTLP Configuration"
# =============================================================================

OTEL_SERVICE_NAME=sentry-build-otlp-workshop-api
OTEL_EXPORTER_OTLP_TRACES_ENDPOINT=https://YOUR-ORG-ID.ingest.us.sentry.io/api/YOUR-PROJECT-ID/integration/otlp/v1/traces
OTEL_EXPORTER_OTLP_TRACES_HEADERS=x-sentry-auth=sentry sentry_key=YOUR_PUBLIC_KEY

# Optional: Also send logs
OTEL_EXPORTER_OTLP_LOGS_ENDPOINT=https://YOUR-ORG-ID.ingest.us.sentry.io/api/YOUR-PROJECT-ID/integration/otlp/v1/logs
OTEL_EXPORTER_OTLP_LOGS_HEADERS=x-sentry-auth=sentry sentry_key=YOUR_PUBLIC_KEY

# =============================================================================
# MODE 2: COLLECTOR (Multi-Project Routing)
# =============================================================================
# Multiple microservices → OTEL Collector → Multiple Sentry projects
# This demonstrates the workaround for Sentry's project-based architecture.
#
# The Challenge:
#   When multiple services send to one collector, how do you route each
#   service's data to a separate Sentry project?
#
# The Solution:
#   Use the OTEL Collector's routing connector to route by service.name
#   attribute to separate pipelines, each with its own Sentry project.
#
# To run:
#   Terminal 1: npm run collector:start
#   Terminal 2: npm run collector:products
#   Terminal 3: npm run collector:orders
#
# Setup:
#   1. Create 3 Sentry projects (products, orders, default)
#   2. Get OTLP endpoint and auth for each project
#   3. Fill in the variables below
#   4. Run the collector and services
#
# See docs/MULTI_PROJECT_ROUTING.md for detailed explanation.
# =============================================================================

# Products Service → Products Sentry Project
SENTRY_PRODUCTS_OTLP_ENDPOINT=https://YOUR-ORG-ID.ingest.us.sentry.io/api/YOUR-PRODUCTS-PROJECT-ID/integration/otlp
SENTRY_PRODUCTS_AUTH=sentry sentry_key=YOUR_PRODUCTS_PUBLIC_KEY,sentry_version=7

# Orders Service → Orders Sentry Project
SENTRY_ORDERS_OTLP_ENDPOINT=https://YOUR-ORG-ID.ingest.us.sentry.io/api/YOUR-ORDERS-PROJECT-ID/integration/otlp
SENTRY_ORDERS_AUTH=sentry sentry_key=YOUR_ORDERS_PUBLIC_KEY,sentry_version=7

# Default/Fallback → Default Sentry Project (for unmatched services)
SENTRY_DEFAULT_OTLP_ENDPOINT=https://YOUR-ORG-ID.ingest.us.sentry.io/api/YOUR-DEFAULT-PROJECT-ID/integration/otlp
SENTRY_DEFAULT_AUTH=sentry sentry_key=YOUR_DEFAULT_PUBLIC_KEY,sentry_version=7

# Port configuration for collector mode services
PRODUCTS_PORT=3001
ORDERS_PORT=3002

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================

NODE_ENV=development
PORT=3000

# =============================================================================
# DATABASE (PostgreSQL via Neon)
# =============================================================================
# Get from: https://console.neon.tech
# Or run: npx neondb -y (auto-creates database and adds URL to .env)
# =============================================================================

DATABASE_URL=postgresql://YOUR_USER:YOUR_PASSWORD@YOUR_HOST.neon.tech/neondb?sslmode=require
